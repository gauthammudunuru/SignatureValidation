import base64
from io import BytesIO

for idx, img in enumerate(cropped_images):
    buffered = BytesIO()
    img.save(buffered, format="PNG")
    img_b64 = base64.b64encode(buffered.getvalue()).decode("utf-8")
    
    prompt = (
        "You are a document image classifier. "
        "The following is a PNG image encoded in base64. "
        "Classify it into one of: Printed text, Handwritten content, Non-text image. "
        "Reply only with the category name.\n\n"
        f"Image(base64): {img_b64}"
    )
    
    response = client.chat.completion.create(
        model="Qwen3-omni",
        messages=[
            {"role": "system", "content": "You are a helpful assistant for classifying document image crops."},
            {"role": "user", "content": prompt}
        ]
    )
    
    classification = response.choices[0].message.content.strip()
    print(f"Crop {idx+1}: {classification}")
